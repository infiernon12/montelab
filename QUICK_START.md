# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ - YOLOX –î–ï–¢–ï–ö–¢–û–† –ö–ê–†–¢

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!

–ú–æ–¥–µ–ª—å YOLOX —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ë—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

---

## üìù –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ?

### 1. **–£–±—Ä–∞–Ω–æ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 255** (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ!)
   - YOLOX –æ–∂–∏–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 255], –∞ –Ω–µ [0, 1]

### 2. **–£–±—Ä–∞–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è BGR‚ÜíRGB**
   - YOLOX —Ä–∞–±–æ—Ç–∞–µ—Ç —Å BGR (—Å—Ç–∞–Ω–¥–∞—Ä—Ç OpenCV)

### 3. **–î–æ–±–∞–≤–ª–µ–Ω postprocess() —Å NMS**
   - –£–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –¥–µ—Ç–µ–∫—Ü–∏–∏

### 4. **–°–Ω–∏–∂–µ–Ω –ø–æ—Ä–æ–≥ confidence**
   - –° 0.4 –¥–æ 0.25 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è YOLOX)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç:
```bash
python test_detector_real.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ù–∞–π–¥–µ–Ω–æ 4 –∫–∞—Ä—Ç—ã (1 player + 3 board)
- ‚úÖ Confidence –¥–ª—è board: 88-91%
- ‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `detection_result_synthetic.jpg`

### –¢–µ—Å—Ç –Ω–∞ —Å–≤–æ–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö:
1. –ü–æ–ª–æ–∂–∏—Ç–µ `.png` –∏–ª–∏ `.jpg` —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É `C:\MonteLab`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `python test_detector_real.py`
3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `detection_result_*.jpg`

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
Objectness max: 0.0032
–î–µ—Ç–µ–∫—Ü–∏–π: 0
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
Objectness max: 0.9826 (‚Üë –≤ 307 —Ä–∞–∑!)
–î–µ—Ç–µ–∫—Ü–∏–π: 4 –∫–∞—Ä—Ç—ã
Confidence: 88-91% –¥–ª—è board cards
```

---

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

```python
from ml.detector import TableCardDetector

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞
detector = TableCardDetector(
    weights_path="epoch_50_ckpt.pth",
    device="cpu"  # –∏–ª–∏ "cuda" –¥–ª—è GPU
)

# –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
import cv2
frame = cv2.imread("screenshot.png")
detections = detector.predict(frame, confidence_threshold=0.25)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
for det in detections:
    x1, y1, x2, y2 = det.bbox
    kind = det.kind  # "player" –∏–ª–∏ "board"
    score = det.score
    print(f"{kind} card: {score:.2f} at ({x1},{y1},{x2},{y2})")
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–æ—Ä–æ–≥ confidence:
- **Board cards:** 0.25-0.4 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0.25)
- **Player cards:** 0.1-0.25 (–º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∏–∂–µ)

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
- **CPU:** `device="cpu"` (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ)
- **GPU:** `device="cuda"` (–±—ã—Å—Ç—Ä–µ–µ, —Ç—Ä–µ–±—É–µ—Ç CUDA)

### NMS threshold:
- –¢–µ–∫—É—â–∏–π: 0.45 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è YOLOX)
- –£–≤–µ–ª–∏—á–∏—Ç—å ‚Üí –º–µ–Ω—å—à–µ –¥–µ—Ç–µ–∫—Ü–∏–π (—Å—Ç—Ä–æ–∂–µ)
- –£–º–µ–Ω—å—à–∏—Ç—å ‚Üí –±–æ–ª—å—à–µ –¥–µ—Ç–µ–∫—Ü–∏–π (–º—è–≥—á–µ)

---

## üìÅ –§–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ:
- `ml/detector.py` - –î–µ—Ç–µ–∫—Ç–æ—Ä (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω ‚úÖ)
- `epoch_50_ckpt.pth` - –ú–æ–¥–µ–ª—å (AP: 74.8%)

### –¢–µ—Å—Ç—ã:
- `test_detector.py` - –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç
- `test_detector_real.py` - –¢–µ—Å—Ç –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞—Ä—Ç–∞—Ö ‚úÖ

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `YOLOX_FINAL_FIX.md` - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- `YOLOX_FIX_SUMMARY.md` - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- `QUICK_START.md` - –≠—Ç–æ—Ç —Ñ–∞–π–ª

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- `detection_result_synthetic.jpg` - –ü—Ä–∏–º–µ—Ä –¥–µ—Ç–µ–∫—Ü–∏–π

---

## ‚ùì FAQ

### Q: –ü–æ—á–µ–º—É –Ω–∞ –±–µ–ª—ã—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞—Ö –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?
**A:** –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç–∞—Ö –ø–æ–∫–µ—Ä–∞. –ù—É–∂–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç—É—Ä–æ–π, —Å–∏–º–≤–æ–ª–∞–º–∏, –ø–æ—Ö–æ–∂–∏–µ –Ω–∞ –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ.

### Q: –ü–æ—á–µ–º—É player card –∏–º–µ–µ—Ç –Ω–∏–∑–∫–∏–π confidence?
**A:** –ù–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ù–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö –±—É–¥–µ—Ç –≤—ã—à–µ.

### Q: –ö–∞–∫ —É–∑–Ω–∞—Ç—å, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥–µ–ª—å?
**A:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python test_detector_real.py`. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ 3-5 –∫–∞—Ä—Ç —Å confidence 80-90% - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU?
**A:** –î–∞! –ò–∑–º–µ–Ω–∏—Ç–µ `device="cpu"` –Ω–∞ `device="cuda"`. –£—Å–∫–æ—Ä–µ–Ω–∏–µ: ~10-20x.

### Q: –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ?
**A:** –†–µ–≥—É–ª–∏—Ä—É–π—Ç–µ `confidence_threshold`. –ù–∞—á–Ω–∏—Ç–µ —Å 0.25, –µ—Å–ª–∏ –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π - —É–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 0.3-0.4.

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

**–ö–æ–Ω—Ç–∞–∫—Ç—ã:**
- –ú–æ–¥–µ–ª—å: `epoch_50_ckpt.pth` (74.8% AP)
- –ö–ª–∞—Å—Å—ã: BoardCard (0), PlayerCard (1)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: YOLOX-S
